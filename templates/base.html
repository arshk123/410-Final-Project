<!DOCTYPE html>
<html>
    <head>
        {% block head %}
        <title>{% block title %}{% endblock %}</title>
        <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
        <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
        <meta charset="utf-8"/>
        <script type="text/javascript" src="//code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.js"></script>
        <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
        <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
        <script src="//stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
        <script type="text/javascript" src="{{url_for('static', filename='signout.js')}}"></script>
        {% endblock %}
    </head>

    <body class="bg-light">
        {% block navbar %}
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <span class="navbar-brand mb-0 h1 text-light">Music Rater â™ª</span>
            <div class="collapse navbar-collapse" id="navLinks">
                <ul class="navbar-nav mr-auto">
                    {% block navbar_items %}
                    <li class="nav-item">
                        {% if session['username'] %}
                        <a class="nav-link" href="{{url_for('user')}}">Home</a>
                        {% else %}
                        <a class="nav-link" href="{{url_for('index')}}">Home</a>
                        {% endif %}
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{url_for('about')}}">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{url_for('new_artist')}}">Request New Artist</a>
                    </li>
                    {% endblock %}
                </ul>
            </div>
            <div class="col-4">
                <form class="form-inline my-2 my-lg-0" id="searchForm" action="/search" method="get" autocomplete="off">
                    <div class="form-group">
                        <input class="form-control" name="navsearch" type="text" id="navsearch" placeholder="Search for artists" aria-label="Search"/>
                        {# <button type="submit" class="btn btn-light my-2 my-sm-0">Search</button> #}
                    </div>
                </form>
            </div>
            {% if session['username'] %}
            <div class="collapse navbar-collapse justify-content-end" id="navbarUserInfo">
                <span class="navbar-text text-light">Signed in as {{ session['username'] }} </span>
                <button class="btn btn-outline-danger ml-2" id="signOut">Sign Out</button>
            </div>
            {% else %}
            <div class="collapse navbar-collapse justify-content-end" id="navbarSignIn">
                <form action="/login" method="post" class="form-inline my-2 my-lg-0">
                    <input name="email" class="form-control mr-sm-2" type="email" placeholder="Email" required/>
                    <input name="password" class="form-control mr-sm-2" type="password" placeholder="Password" required/>
                    <button class="btn btn-primary" type="submit" id="signIn">Sign In</button>
                </form>
            </div>
            {% endif %}
        </nav>
        {% endblock %}
        {% block content %}
        {% endblock %}
    </body>

    {% block scripts %}
        <script type="text/javascript">
        $(function() {
            $("#navsearch").autocomplete({
                source:function(request, response) {
                    console.log(request.term)
                    $.getJSON("{{url_for('navsearch')}}",{
                        q: request.term, // in flask, "q" will be the argument to look for using request.args
                    }, function(data) {
                        response(data.matching_results); // matching_results from jsonify
                    });
                },
                minLength: 3,
                select: function(event, ui) {
                    window.location.replace("/artist/" + ui.item.value);
                }
            });
        })
        </script>
    {% endblock %}
</html>