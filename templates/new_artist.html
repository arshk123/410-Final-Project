{% extends "base.html" %}
{% block title %}{{ Request New Artist }}{% endblock %}

{% block navbar-items %}
    <li class="nav-item">
        {% if session['username'] %}
        <a class="nav-link" href="{{url_for('user')}}">Home</a>
        {% else %}
        <a class="nav-link" href="{{url_for('index')}}">Home</a>
        {% endif %}
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{url_for('about')}}">About</a>
    </li>
    <li class="nav-item active">
        <a class="nav-link" href="#">Requst New Artist</a>
    </li>
{% endblock %}

{% block content %}
    <div>
        <input name="autocomplete" type="text" id="autocomplete" class="form-control input-lg"/>
    </div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
    $(function() {
        $("#autocomplete").autocomplete({
            source:function(request, response) {
                $.getJSON("{{url_for('autocomplete')}}",{
                    q: request.term, // in flask, "q" will be the argument to look for using request.args
                }, function(data) {
                    response(data.matching_results); // matching_results from jsonify
                });
            },
            minLength: 3,
            select: function(event, ui) {
                $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    data: {artist_name: ui.item.value},
                    url: '/handledata/',
                    success: function(response){
                        console.log(response)
                        window.location.replace(response.redirect_url);
                    }
                });
            }
        });
    })
    </script>
{% endblock %}